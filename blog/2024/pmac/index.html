<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> PMAC 2024 Workshop | fluids, ml &amp; more </title> <meta name="author" content="Rene Winchenbach"> <meta name="description" content="Cross-Validation for Machine Learning"> <meta name="keywords" content="sph, ml, cfd, engineering, datasets, neural networks"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon.png?6c59f284bef0b5330e8e98377eb37b7a"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fluids.dev/blog/2024/pmac/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> fluids, ml &amp; more </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/datasets/">cases </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects &amp; solvers </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">PMAC 2024 Workshop</h1> <p class="post-meta"> Created in January 01, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/formatting"> <i class="fa-solid fa-hashtag fa-sm"></i> formatting</a>   <a href="/blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> code</a>   ·   <a href="/blog/category/sample-posts"> <i class="fa-solid fa-tag fa-sm"></i> sample-posts</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="cross-validation-of-sph-based-machine-learning-models-using-the-taylor-green-vortex-case">Cross-Validation of SPH-based Machine Learning Models using the Taylor-Green Vortex Case</h1> <p>As presented at the <strong>Particle Methods and Applications Conference 2024</strong> co-hosted by LANL and SPHERIC.</p> <p>The Slides: https://docs.google.com/presentation/d/1W1yhR9dHK5ysy2fIDsSPK6_JHSIFXYCW/edit#slide=id.p1</p> <p>Our recent (May 2024) paper published at ICLR 2024: https://openreview.net/forum?id=HKgRwNhI9R</p> <p>Last Years live demo from SPHERIC 2023 (Rhodes) using Continuous Convolutions to learn a kernel function: https://colab.research.google.com/drive/1wdJoWvu1U5pftkjpjG0gb0ldSh5-CgDX (if the code doesnt work contact me please)</p> <p>If you have any suggestions or ideas or collaboration ideas contact me via email at rene.winchenbach at tum.de or find me on linked in: https://www.linkedin.com/in/rene-winchenbach-56a217257/</p> <h2 id="interesting-reads-if-you-are-interested-in-more-machine-learning-in-physics">Interesting reads if you are interested in more machine learning in physics</h2> <ul> <li>Learning Lagrangian Fluid Mechanics with Continuous Convolutions: the baseline of our current research https://openreview.net/forum?id=B1lDoJSYDH</li> <li>Guaranteed Conservation of Momentum for Learning Particle-based Fluid Dynamics: a follow up work on the prior paper that builds in hard constraints to ensure conservation of momentum https://arxiv.org/abs/2210.06036</li> <li>Physics informed machine learning with Smoothed Particle Hydrodynamics: Hierarchy of reduced Lagrangian models of turbulence: The paper presented by Michael Woodward at PMAC https://arxiv.org/abs/2110.13311</li> <li>Message-Passing Neural PDE Solvers: A state of the art graph based neural network approach to solving generic PDEs https://openreview.net/forum?id=vSix3HPYKSU</li> </ul> <h2 id="what-we-plan-on-doing-next">What we plan on doing next:</h2> <ul> <li>Hybrid solvers, e.g., low order SPH method + Neural network corrections to achieve higher order accuracy</li> <li>Investigating more general Radial Basis Function Networks for particle mechanics</li> <li>Learning specific subparts of an SPH simulation that are really expensive, e.g., the recent iterative particle shifting method</li> <li>Publishing our dataset (after some more work to make it more representative) as a dataset paper</li> </ul> <h2 id="finally-an-interesting-example-like-mentioned">Finally an interesting example like mentioned</h2> <p>Heres an example from a ground truth trajectory <img src="2023-05-22-13-14-57.png" alt=""> Shown here is a distribution of relative particle positions sampled over a few timesteps (left) and for a single step (right). In the ground truth we see a clear formation of two <em>rings</em> at $\Delta x$ and $2\Delta x$ with a minimum particle separation but an otherwise uniform distribution. Now consider a machine learning trajectory: <img src="2023-05-22-13-18-55.png" alt=""> Here we still see the two rings and uniformity but the minimum particle separation is lower. This can often lead to issues during inference as those distributions are not included in the training data, albeit this can be reduced in impact by using unroll noise and data augmentation (to an extent). Now consider this method: <img src="2023-05-22-13-19-31.png" alt=""> Which shows a highly biased distribution that aligns much closer to a rectilinear grid than an isotroptic distribution with a much lower minimum distance between particles. While this looks worse, and arguably is, this method is more stable in a lot of cases as this distribution acts as a stabilizing measure by regularizing the particle positions, similar to particle shifting. Note that the real reason we got these results was that the method in the last picture wasnt implemented properly and the <em>bug</em> lead to an interesting and, somewhat, improved result.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Rene Winchenbach. If you can't solve it, just learn it. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-cases",title:"cases",description:"A collection of both validation cases, including their setup and execution with diffSPH (if implemented), and also datasets that can be used for training networks. Validation cases will also eventually contain sample trajectories for testing.",section:"Navigation",handler:()=>{window.location.href="/datasets/"}},{id:"nav-projects-amp-solvers",title:"projects & solvers",description:"A collection of solvers and other projects I have written in the past or am currently working on.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"Edit the `_data/repositories.yml` and change the `github_users` and `github_repos` lists to include your own GitHub profile and repositories.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-teaching",title:"teaching",description:"Materials for courses in the past.",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"post-partibench",title:"partibench",description:"partibench data and examples are now live",section:"Posts",handler:()=>{window.location.href="/blog/2024/party/"}},{id:"post-spheric-2024-workshop",title:"SPHERIC 2024 Workshop",description:"Physically-Motivated Machine Learning Models for Lagrangian Fluid Mechanics",section:"Posts",handler:()=>{window.location.href="/blog/2024/spheric/"}},{id:"post-pmac-2024-workshop",title:"PMAC 2024 Workshop",description:"Cross-Validation for Machine Learning",section:"Posts",handler:()=>{window.location.href="/blog/2024/pmac/"}},{id:"post-pmac-copy",title:"Pmac copy",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/pmac-copy/"}},{id:"datasets-hydrostatic-pressure",title:"Hydrostatic Pressure",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/boundary_01_hydrostatic_pressure/"}},{id:"datasets-still-water",title:"Still Water",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/boundary_02_still_water/"}},{id:"datasets-couette-flow",title:"Couette Flow",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/boundary_05_couette/"}},{id:"datasets-lid-driven-cavity",title:"Lid Driven Cavity",description:"Has Example",section:"Datasets",handler:()=>{window.location.href="/datasets/closed_01_ldc/"}},{id:"datasets-flow-past-cylinder",title:"Flow Past Cylinder",description:"Has Example",section:"Datasets",handler:()=>{window.location.href="/datasets/closed_03_FlowPastCylinder/"}},{id:"datasets-driven-square-flow",title:"Driven Square Flow",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/closed_05_Moving_Square/"}},{id:"datasets-sod-shock-tube",title:"Sod Shock Tube",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_01_sodshock/"}},{id:"datasets-woodward-colella-double-blastwave",title:"Woodward Colella Double Blastwave",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_02_doubleBlast/"}},{id:"datasets-hydrostatic-pressure",title:"Hydrostatic Pressure",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_03_hydrostatic/"}},{id:"datasets-linear-wave-propagation",title:"Linear Wave Propagation",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_04_linear/"}},{id:"datasets-noh-implosion",title:"Noh Implosion",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_05_noh/"}},{id:"datasets-kidder-isentropic-compression",title:"Kidder Isentropic Compression",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_06_kidder/"}},{id:"datasets-sedov-taylor-blastwave",title:"Sedov Taylor Blastwave",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_07_sedovTaylor/"}},{id:"datasets-kevin-helmholtz-instability",title:"Kevin Helmholtz Instability",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_08_kevinHH/"}},{id:"datasets-gresho-vortex",title:"Gresho Vortex",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_09_Gresho/"}},{id:"datasets-rayleigh-taylor",title:"Rayleigh Taylor",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/compressible_10_rayleighTaylor/"}},{id:"datasets-wcsph-dataset",title:"WCSPH Dataset",description:"Dataset of periodic flows",section:"Datasets",handler:()=>{window.location.href="/datasets/dataset_00_periodic/"}},{id:"datasets-wcsph-dataset",title:"WCSPH Dataset",description:"Dataset of free-slip flows in 2D",section:"Datasets",handler:()=>{window.location.href="/datasets/dataset_01_free_slip/"}},{id:"datasets-wcsph-dataset",title:"WCSPH Dataset",description:"Dataset of no-slip flows in 2D",section:"Datasets",handler:()=>{window.location.href="/datasets/dataset_02_no_slip/"}},{id:"datasets-oscillating-droplet",title:"Oscillating Droplet",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/freesurface_01_oscillating_drop/"}},{id:"datasets-rotating-square-patch",title:"Rotating Square Patch",description:"Has Example",section:"Datasets",handler:()=>{window.location.href="/datasets/freesurface_02_rotating_patch/"}},{id:"datasets-impact-of-two-squares",title:"Impact of two Squares",description:"Has Example",section:"Datasets",handler:()=>{window.location.href="/datasets/freesurface_02_square_impact/"}},{id:"datasets-impact-of-two-spheres",title:"Impact of Two Spheres",description:"with background image",section:"Datasets",handler:()=>{window.location.href="/datasets/freesurface_03_sphere_impact/"}},{id:"datasets-iclr-dataset",title:"ICLR Dataset",description:"A description of the dataset used for our 2024 ICLR Paper",section:"Datasets",handler:()=>{window.location.href="/datasets/periodic_00_dataset_ICLR/"}},{id:"datasets-taylor-green-vortex",title:"Taylor Green Vortex",description:"Has Example",section:"Datasets",handler:()=>{window.location.href="/datasets/periodic_01_tgv/"}},{id:"datasets-decaying-turbulence-2d",title:"Decaying Turbulence (2D)",description:"Not yet implemented",section:"Datasets",handler:()=>{window.location.href="/datasets/periodic_02_decaying/"}},{id:"datasets-kolmogorov-flow",title:"Kolmogorov Flow",description:"Not yet implemented",section:"Datasets",handler:()=>{window.location.href="/datasets/periodic_03_kolmogorov/"}},{id:"datasets-reverse-pouseille-flow",title:"Reverse Pouseille Flow",description:"Not yet implemented",section:"Datasets",handler:()=>{window.location.href="/datasets/periodic_06_reverse_pouseille/"}},{id:"datasets-sloshing-tank",title:"Sloshing Tank",description:"Not yet implemented",section:"Datasets",handler:()=>{window.location.href="/datasets/simulation_01_sloshing/"}},{id:"datasets-dam-break",title:"Dam Break",description:"Not yet implemented",section:"Datasets",handler:()=>{window.location.href="/datasets/simulation_02_dambreak/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-openmaelstrom",title:"OpenMaelstrom",description:"A description of the OpenMaelstrom solver",section:"Projects",handler:()=>{window.location.href="/projects/solver_01_openMaelstrom/"}},{id:"projects-omnisph",title:"OmniSPH",description:"A description of the omniSPH solver",section:"Projects",handler:()=>{window.location.href="/projects/solver_02_omniSPH/"}},{id:"projects-diffsph",title:"DiffSPH",description:"A description of the diffSPH solver",section:"Projects",handler:()=>{window.location.href="/projects/solver_03_diffSPH/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%63%6F%6E%74%61%63%74@%66%6C%75%69%64%73.%64%65%76","_blank")}},{id:"socials-orcid",title:"ORCID",section:"Socials",handler:()=>{window.open("https://orcid.org/0000-0003-2446-9412","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/wi-re","_blank")}},{id:"socials-flickr",title:"Flickr",section:"Socials",handler:()=>{window.open("https://www.flickr.com/138415691@N05","_blank")}},{id:"socials-dblp",title:"DBLP",section:"Socials",handler:()=>{window.open("https://dblp.org/pid/184/1286.html","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>